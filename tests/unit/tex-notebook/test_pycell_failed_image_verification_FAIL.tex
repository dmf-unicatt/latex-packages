\documentclass{book}
\usepackage{tests-tex-notebook}

\begin{document}

\chapter{Case with image mismatch}

LaTeX compilation will fail if the python code does not return the expected image.

\begin{pycell}
import plotly.express as px
fig = px.scatter(x=[1, 2, 3], y=[4, 5, 6])
fig
\end{pycell}
\pyexpectedfigure{images/fail_image_verification.png}

\chapter{Cases without expected image}

Setting the expected image is not mandatory if the cell doesn't produce any image.

\begin{pycell}
a = 5
\end{pycell}

However, forgetting to declare the expected image for a cell that returns some image will result in a compilation error.
\begin{pycell}
import plotly.express as px
fig = px.scatter(x=[10, 20, 30], y=[40, 50, 60])
fig
\end{pycell}

\ifPythonTeXLoaded
% nothing else to be done
\else
% Mock failure in image verification, since pythontex is not running
\printfailfilelinebyline{expected/\jobname.err.txt}
\fi

\end{document}
