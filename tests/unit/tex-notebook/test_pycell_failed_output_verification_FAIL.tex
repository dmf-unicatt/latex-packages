\documentclass[oneside]{book}
\usepackage{tests-tex-notebook}

\begin{document}

\chapter{Case with output mismatch (simple)}

LaTeX compilation will fail if the python code does not return the expected output.

\section{Simple case}

\begin{pycell}
2 + 2
\end{pycell}
\begin{pyexpectedoutput}
3
\end{pyexpectedoutput}

\chapter{Case with output mismatch (using sympy)}

\begin{pycell}
import sympy
a = sympy.symbols("a")
{a: 1}
\end{pycell}
\begin{pyexpectedoutput}
{b: 2}
\end{pyexpectedoutput}

\chapter{Cases without expected output}

Setting the expected output is not mandatory if the cell doesn't produce any output.

\begin{pycell}
a = 5
\end{pycell}

However, forgetting to declare the expected output for a cell that returns some output will result in a compilation error.
\begin{pycell}
3 + 3
\end{pycell}

\ifPythonTeXLoaded
% nothing else to be done
\else
% Mock failure in output verification, since pythontex is not running
\printfailfilelinebyline{expected/\jobname.err.txt}
\fi

\end{document}
